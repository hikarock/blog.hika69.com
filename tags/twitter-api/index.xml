<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Twitter Api on hikarock blog</title>
    <link>https://blog.hika69.com/tags/twitter-api/</link>
    <description>Recent content in Twitter Api on hikarock blog</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>ja</language>
    <copyright>All rights reserved - 2015</copyright>
    <lastBuildDate>Wed, 20 Apr 2016 00:19:20 +0900</lastBuildDate>
    <atom:link href="https://blog.hika69.com/tags/twitter-api/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>Twitter 検索の結果を Google Drive のスプレッドシートに出力する (その2)</title>
      <link>https://blog.hika69.com/blog/2016/04/20/google-apps-script-v2/</link>
      <pubDate>Wed, 20 Apr 2016 00:19:20 +0900</pubDate>
      
      <guid>https://blog.hika69.com/blog/2016/04/20/google-apps-script-v2/</guid>
      <description>

&lt;p&gt;以前書いたエントリ &lt;a href=&#34;http://blog.hika69.com/blog/2014/01/28/google-apps-script/&#34;&gt;Twitter 検索の結果を Google Drive のスプレッドシートに出力する&lt;/a&gt; の方法が現在使えなくなっているので、代替のスクリプトとその使い方を Gist に置きました。&lt;/p&gt;

&lt;h3 id=&#34;readme-md-https-gist-github-com-hikarock-61fa2cbd933c3ec3abc2afa1830ba68b:1fd485e9c2c175413383efa6ac2e016a&#34;&gt;&lt;a href=&#34;https://gist.github.com/hikarock/61fa2cbd933c3ec3abc2afa1830ba68b&#34;&gt;README.md&lt;/a&gt;&lt;/h3&gt;

&lt;script src=&#34;https://gist.github.com/hikarock/61fa2cbd933c3ec3abc3afa1830ba68b.js&#34;&gt;&lt;/script&gt;

&lt;h3 id=&#34;twitter-gas-js-https-gist-github-com-hikarock-e4d549ddbae5d9d67a1d93b56d69e129:1fd485e9c2c175413383efa6ac2e016a&#34;&gt;&lt;a href=&#34;https://gist.github.com/hikarock/e4d549ddbae5d9d67a1d93b56d69e129&#34;&gt;twitter-gas.js&lt;/a&gt;&lt;/h3&gt;

&lt;script src=&#34;https://gist.github.com/hikarock/e4d549ddbae5d9d67a1d93b56d69e129.js&#34;&gt;&lt;/script&gt;
</description>
    </item>
    
    <item>
      <title>Twitter 検索の結果を Google Drive のスプレッドシートに出力する</title>
      <link>https://blog.hika69.com/blog/2014/01/28/google-apps-script/</link>
      <pubDate>Tue, 28 Jan 2014 17:07:27 +0000</pubDate>
      
      <guid>https://blog.hika69.com/blog/2014/01/28/google-apps-script/</guid>
      <description>

&lt;p&gt;以前Google Apps Scriptで作成したプログラムがTwitter API Ver.1の廃止で動かなくなってたので直しました。&lt;/p&gt;

&lt;p&gt;ついでにライブラリとしてだれでも使えるようにしました。&lt;del&gt;ソースコードはここに置いてます。&lt;/del&gt;&lt;/p&gt;

&lt;p&gt;使い方まとめるよ。&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;2015/10/7 追記: Google Apps Scriptで&lt;code&gt;OAuthConfig&lt;/code&gt;が廃止されたため、このスクリプトは動きません。&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;2016/4/20 追記: 何人かにこのスクリプトが使いたいと要望をもらったので、ちょっと面倒な方法ですが&lt;a href=&#34;https://blog.hika69.com/blog/2016/04/20/google-apps-script-v2/&#34;&gt;ここ&lt;/a&gt;に現在動作するスクリプトの使い方を書きました。&lt;/strong&gt;&lt;/p&gt;

&lt;h3 id=&#34;1-twitterアプリの作成:810c749fc8fa5127bcde89e372276574&#34;&gt;1) Twitterアプリの作成&lt;/h3&gt;

&lt;p&gt;&lt;a href=&#34;https://dev.twitter.com/&#34;&gt;Twitter Developers&lt;/a&gt;でGoogle Apps Script用のアプリを作成してください。&lt;/p&gt;

&lt;p&gt;以下は入力例です。&lt;code&gt;Callback URL&lt;/code&gt;は以下で指定するURLを設定してください。
他の項目は自分がわかりやすいもので。&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Name: &lt;code&gt;GoogleAppsScript&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Description: &lt;code&gt;GoogleAppsScriptから利用します&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Website: &lt;code&gt;http://example.com/&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Callback URL: &lt;code&gt;https://spreadsheets.google.com/macros&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;作成が成功すると&lt;code&gt;Consumer key&lt;/code&gt;と&lt;code&gt;Consumer secret&lt;/code&gt;が発行されます。これはあとで使います。&lt;/p&gt;

&lt;h3 id=&#34;2-スプレッドシートの作成:810c749fc8fa5127bcde89e372276574&#34;&gt;2) スプレッドシートの作成&lt;/h3&gt;

&lt;p&gt;Google Driveでスプレッドシート作成します。&lt;/p&gt;

&lt;p&gt;メニューから&lt;code&gt;ツール &amp;gt; スクリプトエディタ&lt;/code&gt;を選択します。&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://dl.dropboxusercontent.com/u/459142/img/blog/google-apps-script-01.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;「無題のプロジェクト」が開きますので、プロジェクトに適当に名前をつけてください。&lt;/p&gt;

&lt;h3 id=&#34;3-ライブラリの読込:810c749fc8fa5127bcde89e372276574&#34;&gt;3) ライブラリの読込&lt;/h3&gt;

&lt;p&gt;&lt;code&gt;リソース &amp;gt; ライブラリ&lt;/code&gt;を選択すると以下のウィンドウが表示されます。&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://dl.dropboxusercontent.com/u/459142/img/blog/google-apps-script-02.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;「ライブラリを検索」に &lt;code&gt;MHGYgT-unu1fC7zXOkNfBUVSHJARy_IP7&lt;/code&gt; を入力して選択ボタンを押します。&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://dl.dropboxusercontent.com/u/459142/img/blog/google-apps-script-03.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;最新のバージョンを選択します。この例では「1」を選択して保存。&lt;/p&gt;

&lt;h3 id=&#34;4-プロジェクトのプロパティの設定:810c749fc8fa5127bcde89e372276574&#34;&gt;4) プロジェクトのプロパティの設定&lt;/h3&gt;

&lt;p&gt;次に&lt;code&gt;ファイル &amp;gt; プロジェクトのプロパティ&lt;/code&gt;を選択します。
ユーザーのプロパティタブを開いて以下の名前のプロパティを設定します。&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;TWITTER_CONSUMER_SECRET&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;TWITTER_CONSUMER_KEY&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;それぞれに先ほどTwitter Developersで取得した「Consumer key」と「Consumer secret」の値を設定してください。&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://dl.dropboxusercontent.com/u/459142/img/blog/google-apps-script-04.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;h3 id=&#34;5-トリガースクリプトの作成:810c749fc8fa5127bcde89e372276574&#34;&gt;5) トリガースクリプトの作成&lt;/h3&gt;

&lt;p&gt;コード.gsに以下のようなスクリプトを記述してください。
この例は検索キーワード「都知事」で最初(0番目)のシートに検索結果を出力する、という意味です。&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-js&#34;&gt;function myFunction() {
  Twitter.search(&amp;quot;都知事&amp;quot;, 0);
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;実行するとスプレッドシートに検索結果が出力されます。
初回実行時はTwitterとGoogleの承認画面が表示されると思います。&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://dl.dropboxusercontent.com/u/459142/img/blog/google-apps-script-06.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;こんな感じで検索結果が出力されてたら成功。&lt;/p&gt;

&lt;h3 id=&#34;6-定期的に検索を実行する:810c749fc8fa5127bcde89e372276574&#34;&gt;6) 定期的に検索を実行する&lt;/h3&gt;

&lt;p&gt;メニューから&lt;code&gt;リソース &amp;gt; 現在のスクリプトのトリガー&lt;/code&gt;を選択します。&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://dl.dropboxusercontent.com/u/459142/img/blog/google-apps-script-05.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;この設定だと1時間おきに検索が実行されて、検索結果がスプレッドシートに貯まっていきます。&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>